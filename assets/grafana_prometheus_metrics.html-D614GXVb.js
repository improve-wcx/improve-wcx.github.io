import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as e,e as a,o as n}from"./app-LCtBIzYo.js";const t="/assets/img-20220912102054-BfLYHiwL.png",l="/assets/img-20220912102143-BKdPb7W3.png",r="/assets/img-20220912102323-Bzw8Hchk.png",h="/assets/img-20220912102423-D7watN8L.png",p="/assets/img-20220912102502-CbQz2vkN.png",d="/assets/img-20220912102533-B4l55Qu3.png",o="/assets/img-20220912102645-B1ajXpXB.png",k="/assets/img-20220912103538-Cc-uJrec.png",g="/assets/img-20220912103602-DK4ZfS7B.png",c="/assets/img-20220912103611-C5TCYQMH.png",m="/assets/img-20220912103611-C5TCYQMH.png",u="/assets/img-20220912103630-WNe3YQKl.png",y={};function b(F,s){return n(),e("div",null,s[0]||(s[0]=[a(`<h2 id="利用granfana、prometheus、node-exporter示例监控部署" tabindex="-1"><a class="header-anchor" href="#利用granfana、prometheus、node-exporter示例监控部署"><span>利用granfana、prometheus、node_exporter示例监控部署</span></a></h2><h3 id="下载prometheus、grafana、node-exporter程序。" tabindex="-1"><a class="header-anchor" href="#下载prometheus、grafana、node-exporter程序。"><span>下载prometheus、grafana、node_exporter程序。</span></a></h3><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    wget</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> http://file.ethlink.cn/tools/prometheus.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    wget</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> http://file.ethlink.cn/tools/node_export.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    wget</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> http://file.ethlink.cn/tools/grafana_7.3.4_amd64.deb</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="解压tar包-安装grafana" tabindex="-1"><a class="header-anchor" href="#解压tar包-安装grafana"><span>解压tar包，安装grafana</span></a></h3><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    tar</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -zxvf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> prometheus.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    tar</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -zxvf</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> node_export.tar.gz</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    dpkg</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> -i</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> grafana_7.3.4_amd64.deb</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="配置prometheus" tabindex="-1"><a class="header-anchor" href="#配置prometheus"><span>配置prometheus</span></a></h3><pre><code>\`cd prometheus-2.23.0.linux-amd64\`
\`vim prometheus.yml\`
![Img](./FILES/grafana_prometheus_metrics.md/img-20220912101754.png)
填写要监控的主机的IP，端口都是9100 。node_exporter服务端口就是9100。
</code></pre><h3 id="启动prometheus" tabindex="-1"><a class="header-anchor" href="#启动prometheus"><span>启动prometheus</span></a></h3><p><code>vim /etc/systemd/system/prometheus.service</code></p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[Unit]</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">Description</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Prometheus</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Monitoring</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> System</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">Documentation</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">Prometheus</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> Monitoring</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> System</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[Service]</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">ExecStart</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">/home/ubuntu22/tools/prometheus-2.38.0.linux-amd64/prometheus</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> --config.file</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">=/home/ubuntu22/tools/prometheus-2.38.0.linux-amd64/prometheus.yml</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --web.listen-address=:9090</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">Restart</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">on-failure</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[Install]</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">WantedBy</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">multi-user.target</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>加载、开机自启动、启动服务、查看服务、重启服务、停止服务
</code></pre><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> /bin/systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> daemon-reload</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> start</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> prometheus</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> status</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> prometheus</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> restart</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> prometheus</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> stop</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> prometheus</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="配置node" tabindex="-1"><a class="header-anchor" href="#配置node"><span>配置node</span></a></h3><pre><code>\`vim /etc/systemd/system/node_exporter.service\`
写入如下内容：
</code></pre><div class="language-tex line-numbers-mode" data-highlighter="shiki" data-ext="tex" data-title="tex" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[Unit]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Description=node_exporter</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Documentation=https://github.com/prometheus/node_exporter</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[Service]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">ExecStart=/home/wangchenxi/usr/node_exporter-1.4.0-rc.0.linux-amd64/node_exporter --collector.systemd --collector.processes</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">Restart=on-failure</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">[Install]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">WantedBy=multi-user.target</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><pre><code>执行开机自启动服务、启动服务、查看状态
</code></pre><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> daemon-reload</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> enable</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> node_exporter.service</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> start</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> node_exporter.service</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> </span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">sudo</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> systemctl</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> status</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> node_exporter.service</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="配置webui" tabindex="-1"><a class="header-anchor" href="#配置webui"><span>配置webui</span></a></h3><p>打开主机地址+3000端口。<br> 例如：主机IP为192.168.22.23<br> 浏览器输入以下地址： <code>http://192.168.22.23:3000</code><br><img src="`+t+'" alt="Img" loading="lazy"><br> 默认用户为 admin admin</p><p><img src="'+l+'" alt="Img" loading="lazy"><br> 登陆后修改密码</p><h3 id="修改完密码进入主页。准备配置数据源" tabindex="-1"><a class="header-anchor" href="#修改完密码进入主页。准备配置数据源"><span>修改完密码进入主页。准备配置数据源</span></a></h3><p><img src="'+r+'" alt="Img" loading="lazy"><br> 点击Add data source<br><img src="'+h+'" alt="Img" loading="lazy"><br> 选择prometheus<br><img src="'+p+'" alt="Img" loading="lazy"><br> 填入主机的IP,端口号为9090<br><img src="'+d+'" alt="Img" loading="lazy"><br> 点击保存并测试（save&amp;test）<br><img src="'+o+'" alt="Img" loading="lazy"></p><h3 id="导入模板配置" tabindex="-1"><a class="header-anchor" href="#导入模板配置"><span>导入模板配置</span></a></h3><p><img src="'+k+'" alt="Img" loading="lazy"><br><img src="'+g+'" alt="Img" loading="lazy"><br><img src="'+c+'" alt="Img" loading="lazy"><br><img src="'+m+'" alt="Img" loading="lazy"><br><img src="'+u+`" alt="Img" loading="lazy"></p><h3 id="搭建其他服务的监控" tabindex="-1"><a class="header-anchor" href="#搭建其他服务的监控"><span>搭建其他服务的监控</span></a></h3><pre><code>1. 例如mysql、nginx这些都有对应的，监控模板和对应的node服务，可以自行查找攻略；
2. 如果要监控自主开发的服务或系统，需要自己实现对应的prometheus_client，然后在prometheus中配置添加对应节点。
</code></pre><h3 id="proql" tabindex="-1"><a class="header-anchor" href="#proql"><span>ProQL</span></a></h3><p>如果要自己定义展示模板，可以学习prometheus的query language，简称<code>ProQL</code>。</p>`,28)]))}const _=i(y,[["render",b],["__file","grafana_prometheus_metrics.html.vue"]]),f=JSON.parse('{"path":"/posts/banana/prometheus/grafana_prometheus_metrics.html","title":"","lang":"zh-CN","frontmatter":{"icon":"pen-to-square","date":"2022-01-05T00:00:00.000Z","category":["工具","prometheus","granfana","node_exporter"],"tag":["黄"],"description":"利用granfana、prometheus、node_exporter示例监控部署 下载prometheus、grafana、node_exporter程序。 解压tar包，安装grafana 配置prometheus 启动prometheus vim /etc/systemd/system/prometheus.service 配置node 配置we...","head":[["meta",{"property":"og:url","content":"https://improve-wcx.github.io/posts/banana/prometheus/grafana_prometheus_metrics.html"}],["meta",{"property":"og:site_name","content":"登峰造极"}],["meta",{"property":"og:description","content":"利用granfana、prometheus、node_exporter示例监控部署 下载prometheus、grafana、node_exporter程序。 解压tar包，安装grafana 配置prometheus 启动prometheus vim /etc/systemd/system/prometheus.service 配置node 配置we..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-02-19T11:29:03.000Z"}],["meta",{"property":"article:tag","content":"黄"}],["meta",{"property":"article:published_time","content":"2022-01-05T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-02-19T11:29:03.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2022-01-05T00:00:00.000Z\\",\\"dateModified\\":\\"2025-02-19T11:29:03.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"王晨曦\\",\\"url\\":\\"https://improve-wcx.github.io\\"}]}"]]},"headers":[{"level":2,"title":"利用granfana、prometheus、node_exporter示例监控部署","slug":"利用granfana、prometheus、node-exporter示例监控部署","link":"#利用granfana、prometheus、node-exporter示例监控部署","children":[{"level":3,"title":"下载prometheus、grafana、node_exporter程序。","slug":"下载prometheus、grafana、node-exporter程序。","link":"#下载prometheus、grafana、node-exporter程序。","children":[]},{"level":3,"title":"解压tar包，安装grafana","slug":"解压tar包-安装grafana","link":"#解压tar包-安装grafana","children":[]},{"level":3,"title":"配置prometheus","slug":"配置prometheus","link":"#配置prometheus","children":[]},{"level":3,"title":"启动prometheus","slug":"启动prometheus","link":"#启动prometheus","children":[]},{"level":3,"title":"配置node","slug":"配置node","link":"#配置node","children":[]},{"level":3,"title":"配置webui","slug":"配置webui","link":"#配置webui","children":[]},{"level":3,"title":"修改完密码进入主页。准备配置数据源","slug":"修改完密码进入主页。准备配置数据源","link":"#修改完密码进入主页。准备配置数据源","children":[]},{"level":3,"title":"导入模板配置","slug":"导入模板配置","link":"#导入模板配置","children":[]},{"level":3,"title":"搭建其他服务的监控","slug":"搭建其他服务的监控","link":"#搭建其他服务的监控","children":[]},{"level":3,"title":"ProQL","slug":"proql","link":"#proql","children":[]}]}],"git":{"createdTime":1739963485000,"updatedTime":1739964543000,"contributors":[{"name":"晨曦001","username":"晨曦001","email":"chinawangchenxi@163.com","commits":2,"url":"https://github.com/晨曦001"}]},"readingTime":{"minutes":1.58,"words":474},"filePathRelative":"posts/banana/prometheus/grafana_prometheus_metrics.md","localizedDate":"2022年1月5日","excerpt":"<h2>利用granfana、prometheus、node_exporter示例监控部署</h2>\\n<h3>下载prometheus、grafana、node_exporter程序。</h3>\\n<div class=\\"language-shell line-numbers-mode\\" data-highlighter=\\"shiki\\" data-ext=\\"shell\\" data-title=\\"shell\\" style=\\"--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34\\"><pre class=\\"shiki shiki-themes one-light one-dark-pro vp-code\\"><code><span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">    wget</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> http://file.ethlink.cn/tools/prometheus.tar.gz</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">    wget</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> http://file.ethlink.cn/tools/node_export.tar.gz</span></span>\\n<span class=\\"line\\"><span style=\\"--shiki-light:#4078F2;--shiki-dark:#61AFEF\\">    wget</span><span style=\\"--shiki-light:#50A14F;--shiki-dark:#98C379\\"> http://file.ethlink.cn/tools/grafana_7.3.4_amd64.deb</span></span></code></pre>\\n<div class=\\"line-numbers\\" aria-hidden=\\"true\\" style=\\"counter-reset:line-number 0\\"><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div><div class=\\"line-number\\"></div></div></div>","autoDesc":true}');export{_ as comp,f as data};
